import { Component, ViewChild, Input, Output, EventEmitter, ViewEncapsulation } from '@angular/core';
import { FusionGridService } from './fusion-grid.service';
import Events from './events';
export class FusionGridComponent {
    constructor(fusionGridService) {
        this.fusionGridService = fusionGridService;
        this.gridEvents = Events;
        this.eventMapper = {};
        // Events
        this.initialized = new EventEmitter();
        this.beforeRender = new EventEmitter();
        this.rendered = new EventEmitter();
        this.updated = new EventEmitter();
        this.resized = new EventEmitter();
        this.disposed = new EventEmitter();
        this.rowHovered = new EventEmitter();
        this.columnHovered = new EventEmitter();
        this.rowDoubleClicked = new EventEmitter();
        this.headerClicked = new EventEmitter();
        this.cardClicked = new EventEmitter();
        this.cardDoubleClicked = new EventEmitter();
        this.recordClicked = new EventEmitter();
        this.recordDoubleClicked = new EventEmitter();
    }
    set gridConfig(config) {
        this.updateGridConfig(config);
        this._gridConfig = config;
    }
    get gridConfig() {
        return this._gridConfig;
    }
    set dataTable(dataTable) {
        this.updateDataTable(dataTable);
        this._dataTable = dataTable;
    }
    get dataTable() {
        return this._dataTable;
    }
    ngAfterViewInit() {
        const grid = this.fusionGridService.fusionGrid;
        this.gridRef = new grid(this.gridContainer.nativeElement, this.dataTable, this.gridConfig);
        this.initialized.emit({ grid: this.gridRef });
        this.addGridEvents();
        this.gridRef.render();
    }
    ngOnDestroy() {
        if (!this.gridRef.dispose) {
            this.gridContainer.nativeElement.remove();
            return;
        }
        this.gridRef.dispose();
    }
    /** Attch the Events dynamically if its available in the component component */
    addGridEvents() {
        this.gridEvents.forEach((eventName) => {
            const eventSource = this[eventName];
            this.eventMapper[eventName.toLocaleLowerCase()] = eventName;
            //Check Weather the event is subscribed
            if (eventSource.observers.length) {
                const callbackFn = (event, data) => {
                    this[this.eventMapper[event.type]].emit({ event, data });
                };
                this.gridRef.on(eventName, callbackFn);
            }
        });
    }
    /** Call the specific setter method once we update the config reference */
    updateGridConfig(config) {
        if (!this.gridRef) {
            return;
        }
        Object.entries(config).forEach(([key, value]) => {
            if (this.gridConfig[key] !== config[key]) {
                const setterMethod = `set${key.charAt(0).toUpperCase()}${key.slice(1)}`;
                this.gridRef[setterMethod] && this.gridRef[setterMethod](value);
            }
        });
    }
    updateDataTable(dataTable) {
        if (!this.gridRef) {
            return;
        }
        this.gridRef.setDataTable(dataTable);
    }
}
FusionGridComponent.decorators = [
    { type: Component, args: [{
                selector: 'fusion-grid',
                template: `<div #gridContainer style="width:100%;height:100%"></div>`,
                host: {
                    'class': 'fusion-grid-container'
                },
                encapsulation: ViewEncapsulation.None,
                styles: ['.fusion-grid-container{ display: block; }']
            },] }
];
FusionGridComponent.ctorParameters = () => [
    { type: FusionGridService }
];
FusionGridComponent.propDecorators = {
    gridConfig: [{ type: Input }],
    dataTable: [{ type: Input }],
    gridContainer: [{ type: ViewChild, args: ['gridContainer',] }],
    initialized: [{ type: Output }],
    beforeRender: [{ type: Output }],
    rendered: [{ type: Output }],
    updated: [{ type: Output }],
    resized: [{ type: Output }],
    disposed: [{ type: Output }],
    rowHovered: [{ type: Output }],
    columnHovered: [{ type: Output }],
    rowDoubleClicked: [{ type: Output }],
    headerClicked: [{ type: Output }],
    cardClicked: [{ type: Output }],
    cardDoubleClicked: [{ type: Output }],
    recordClicked: [{ type: Output }],
    recordDoubleClicked: [{ type: Output }]
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZnVzaW9uLWdyaWQuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vcHJvamVjdHMvZnVzaW9uLWdyaWQvc3JjL2xpYi9mdXNpb24tZ3JpZC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFNBQVMsRUFBYyxTQUFTLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBNEIsWUFBWSxFQUFFLGlCQUFpQixFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQzNJLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLHVCQUF1QixDQUFDO0FBQzFELE9BQU8sTUFBTSxNQUFNLFVBQVUsQ0FBQztBQVk5QixNQUFNLE9BQU8sbUJBQW1CO0lBTTlCLFlBQW9CLGlCQUFvQztRQUFwQyxzQkFBaUIsR0FBakIsaUJBQWlCLENBQW1CO1FBSmhELGVBQVUsR0FBYSxNQUFNLENBQUM7UUFDOUIsZ0JBQVcsR0FBMEIsRUFBRSxDQUFDO1FBNEJoRCxTQUFTO1FBQ0MsZ0JBQVcsR0FBRyxJQUFJLFlBQVksRUFBbUIsQ0FBQztRQUVsRCxpQkFBWSxHQUFHLElBQUksWUFBWSxFQUFhLENBQUM7UUFFN0MsYUFBUSxHQUFHLElBQUksWUFBWSxFQUFhLENBQUM7UUFFekMsWUFBTyxHQUFHLElBQUksWUFBWSxFQUFhLENBQUM7UUFFeEMsWUFBTyxHQUFHLElBQUksWUFBWSxFQUFhLENBQUM7UUFFeEMsYUFBUSxHQUFHLElBQUksWUFBWSxFQUFhLENBQUM7UUFFekMsZUFBVSxHQUFHLElBQUksWUFBWSxFQUFhLENBQUM7UUFFM0Msa0JBQWEsR0FBRyxJQUFJLFlBQVksRUFBYSxDQUFDO1FBRTlDLHFCQUFnQixHQUFHLElBQUksWUFBWSxFQUFhLENBQUM7UUFFakQsa0JBQWEsR0FBRyxJQUFJLFlBQVksRUFBYSxDQUFDO1FBRTlDLGdCQUFXLEdBQUcsSUFBSSxZQUFZLEVBQWEsQ0FBQztRQUU1QyxzQkFBaUIsR0FBRyxJQUFJ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RUFBRSxHQUFHLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQztnQkFDeEUsSUFBSSxDQUFDLE9BQU8sQ0FBQyxZQUFZLENBQUMsSUFBSSxJQUFJLENBQUMsT0FBTyxDQUFDLFlBQVksQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDO2FBQ2pFO1FBQ0gsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDO0lBRUQsZUFBZSxDQUFDLFNBQWM7UUFDNUIsSUFBRyxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUM7WUFDZixPQUFPO1NBQ1I7UUFDRCxJQUFJLENBQUMsT0FBTyxDQUFDLFlBQVksQ0FBQyxTQUFTLENBQUMsQ0FBQztJQUN2QyxDQUFDOzs7WUF4SEYsU0FBUyxTQUFDO2dCQUNULFFBQVEsRUFBRSxhQUFhO2dCQUN2QixRQUFRLEVBQUUsMkRBQTJEO2dCQUVyRSxJQUFJLEVBQUM7b0JBQ0gsT0FBTyxFQUFDLHVCQUF1QjtpQkFDaEM7Z0JBQ0QsYUFBYSxFQUFDLGlCQUFpQixDQUFDLElBQUk7eUJBSjVCLDJDQUEyQzthQUtwRDs7O1lBWlEsaUJBQWlCOzs7eUJBc0J2QixLQUFLO3dCQVVMLEtBQUs7NEJBVUwsU0FBUyxTQUFDLGVBQWU7MEJBR3pCLE1BQU07MkJBRU4sTUFBTTt1QkFFTixNQUFNO3NCQUVOLE1BQU07c0JBRU4sTUFBTTt1QkFFTixNQUFNO3lCQUVOLE1BQU07NEJBRU4sTUFBTTsrQkFFTixNQUFNOzRCQUVOLE1BQU07MEJBRU4sTUFBTTtnQ0FFTixNQUFNOzRCQUVOLE1BQU07a0NBRU4sTUFBTSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgRWxlbWVudFJlZiwgVmlld0NoaWxkLCBJbnB1dCwgT3V0cHV0LCBBZnRlclZpZXdJbml0LCBPbkRlc3Ryb3ksIEV2ZW50RW1pdHRlciwgVmlld0VuY2Fwc3VsYXRpb24gfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IEZ1c2lvbkdyaWRTZXJ2aWNlIH0gZnJvbSAnLi9mdXNpb24tZ3JpZC5zZXJ2aWNlJztcbmltcG9ydCBFdmVudHMgZnJvbSAnLi9ldmVudHMnO1xuaW1wb3J0IHsgR3JpZEV2ZW50LCBHcmlkSW5pdGlhbGl6ZWQgfSBmcm9tICcuL2Z1c2lvbi1ncmlkLmludGVyZmFjZSc7XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ2Z1c2lvbi1ncmlkJyxcbiAgdGVtcGxhdGU6IGA8ZGl2ICNncmlkQ29udGFpbmVyIHN0eWxlPVwid2lkdGg6MTAwJTtoZWlnaHQ6MTAwJVwiPjwvZGl2PmAsXG4gIHN0eWxlczpbJy5mdXNpb24tZ3JpZC1jb250YWluZXJ7IGRpc3BsYXk6IGJsb2NrOyB9J10sXG4gIGhvc3Q6e1xuICAgICdjbGFzcyc6J2Z1c2lvbi1ncmlkLWNvbnRhaW5lcidcbiAgfSxcbiAgZW5jYXBzdWxhdGlvbjpWaWV3RW5jYXBzdWxhdGlvbi5Ob25lXG59KVxuZXhwb3J0IGNsYXNzIEZ1c2lvbkdyaWRDb21wb25lbnQgaW1wbGVtZW50cyBBZnRlclZpZXdJbml0LCBPbkRlc3Ryb3kge1xuXG4gIHByaXZhdGUgZ3JpZEV2ZW50czogc3RyaW5nW10gPSBFdmVudHM7XG4gIHByaXZhdGUgZXZlbnRNYXBwZXI6IHtba2V5OnN0cmluZ106c3RyaW5nfSA9IHt9O1xuICBwcml2YXRlIGdyaWRSZWY6IGFueTtcblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIGZ1c2lvbkdyaWRTZXJ2aWNlOiBGdXNpb25HcmlkU2VydmljZSkge31cblxuICBfZ3JpZENvbmZpZzogYW55O1xuICBASW5wdXQoKSBcbiAgc2V0IGdyaWRDb25maWcoY29uZmlnOiBhbnkpIHtcbiAgICB0aGlzLnVwZGF0ZUdyaWRDb25maWcoY29uZmlnKTtcbiAgICB0aGlzLl9ncmlkQ29uZmlnID0gY29uZmlnO1xuICB9XG4gIGdldCBncmlkQ29uZmlnKCk6IGFueSB7XG4gICAgcmV0dXJuIHRoaXMuX2dyaWRDb25maWc7XG4gIH1cblxuICBfZGF0YVRhYmxlOiBhbnk7XG4gIEBJbnB1dCgpIFxuICBzZXQgZGF0YVRhYmxlKGRhdGFUYWJsZTogYW55KXtcbiAgICB0aGlzLnVwZGF0ZURhdGFUYWJsZShkYXRhVGFibGUpO1xuICAgIHRoaXMuX2RhdGFUYWJsZSA9IGRhdGFUYWJsZTtcbiAgfVxuXG4gIGdldCBkYXRhVGFibGUoKTogYW55IHtcbiAgICByZXR1cm4gdGhpcy5fZGF0YVRhYmxlO1xuICB9XG5cbiAgQFZpZXdDaGlsZCgnZ3JpZENvbnRhaW5lcicpIGdyaWRDb250YWluZXI6IEVsZW1lbnRSZWY7XG5cbiAgLy8gRXZlbnRzXG4gIEBPdXRwdXQoKSBpbml0aWFsaXplZCA9IG5ldyBFdmVudEVtaXR0ZXI8R3JpZEluaXRpYWxpemVkPigpO1xuXG4gIEBPdXRwdXQoKSBiZWZvcmVSZW5kZXIgPSBuZXcgRXZlbnRFbWl0dGVyPEdyaWRFdmVudD4oKTtcblxuICBAT3V0cHV0KCkgcmVuZGVyZWQgPSBuZXcgRXZlbnRFbWl0dGVyPEdyaWRFdmVudD4oKTtcblxuICBAT3V0cHV0KCkgdXBkYXRlZCA9IG5ldyBFdmVudEVtaXR0ZXI8R3JpZEV2ZW50PigpO1xuXG4gIEBPdXRwdXQoKSByZXNpemVkID0gbmV3IEV2ZW50RW1pdHRlcjxHcmlkRXZlbnQ+KCk7XG5cbiAgQE91dHB1dCgpIGRpc3Bvc2VkID0gbmV3IEV2ZW50RW1pdHRlcjxHcmlkRXZlbnQ+KCk7XG5cbiAgQE91dHB1dCgpIHJvd0hvdmVyZWQgPSBuZXcgRXZlbnRFbWl0dGVyPEdyaWRFdmVudD4oKTtcblxuICBAT3V0cHV0KCkgY29sdW1uSG92ZXJlZCA9IG5ldyBFdmVudEVtaXR0ZXI8R3JpZEV2ZW50PigpO1xuXG4gIEBPdXRwdXQoKSByb3dEb3VibGVDbGlja2VkID0gbmV3IEV2ZW50RW1pdHRlcjxHcmlkRXZlbnQ+KCk7XG5cbiAgQE91dHB1dCgpIGhlYWRlckNsaWNrZWQgPSBuZXcgRXZlbnRFbWl0dGVyPEdyaWRFdmVudD4oKTtcblxuICBAT3V0cHV0KCkgY2FyZENsaWNrZWQgPSBuZXcgRXZlbnRFbWl0dGVyPEdyaWRFdmVudD4oKTtcblxuICBAT3V0cHV0KCkgY2FyZERvdWJsZUNsaWNrZWQgPSBuZXcgRXZlbnRFbWl0dGVyPEdyaWRFdmVudD4oKTtcblxuICBAT3V0cHV0KCkgcmVjb3JkQ2xpY2tlZCA9IG5ldyBFdmVudEVtaXR0ZXI8R3JpZEV2ZW50PigpO1xuXG4gIEBPdXRwdXQoKSByZWNvcmREb3VibGVDbGlja2VkID0gbmV3IEV2ZW50RW1pdHRlcjxHcmlkRXZlbnQ+KCk7XG4gIFxuICBcbiAgbmdBZnRlclZpZXdJbml0KCkge1xuICAgIGNvbnN0IGdyaWQgPSB0aGlzLmZ1c2lvbkdyaWRTZXJ2aWNlLmZ1c2lvbkdyaWQ7XG4gICAgdGhpcy5ncmlkUmVmID0gbmV3IGdyaWQodGhpcy5ncmlkQ29udGFpbmVyLm5hdGl2ZUVsZW1lbnQsIHRoaXMuZGF0YVRhYmxlLCB0aGlzLmdyaWRDb25maWcpO1xuICAgIHRoaXMuaW5pdGlhbGl6ZWQuZW1pdCh7Z3JpZDogdGhpcy5ncmlkUmVmfSk7XG4gICAgdGhpcy5hZGRHcmlkRXZlbnRzKCk7XG4gICAgdGhpcy5ncmlkUmVmLnJlbmRlcigpO1xuICB9XG5cbiAgbmdPbkRlc3Ryb3koKSB7XG4gICAgaWYoIXRoaXMuZ3JpZFJlZi5kaXNwb3NlKSB7XG4gICAgICB0aGlzLmdyaWRDb250YWluZXIubmF0aXZlRWxlbWVudC5yZW1vdmUoKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLmdyaWRSZWYuZGlzcG9zZSgpO1xuICB9XG5cbiAgLyoqIEF0dGNoIHRoZSBFdmVudHMgZHluYW1pY2FsbHkgaWYgaXRzIGF2YWlsYWJsZSBpbiB0aGUgY29tcG9uZW50IGNvbXBvbmVudCAqL1xuICBwcml2YXRlIGFkZEdyaWRFdmVudHMoKTogdm9pZCB7XG4gICAgdGhpcy5ncmlkRXZlbnRzLmZvckVhY2goKGV2ZW50TmFtZTogc3RyaW5nKT0+IHtcbiAgICAgIGNvbnN0IGV2ZW50U291cmNlID0gdGhpc1tldmVudE5hbWVdIGFzIEV2ZW50RW1pdHRlcjxhbnk+O1xuICAgICAgdGhpcy5ldmVudE1hcHBlcltldmVudE5hbWUudG9Mb2NhbGVMb3dlckNhc2UoKV0gPSBldmVudE5hbWU7XG4gICAgICAvL0NoZWNrIFdlYXRoZXIgdGhlIGV2ZW50IGlzIHN1YnNjcmliZWRcbiAgICAgIGlmKGV2ZW50U291cmNlLm9ic2VydmVycy5sZW5ndGgpIHtcbiAgICAgICAgY29uc3QgY2FsbGJhY2tGbiA9IChldmVudDogYW55LCBkYXRhOiBhbnkpID0+IHtcbiAgICAgICAgICB0aGlzW3RoaXMuZXZlbnRNYXBwZXJbZXZlbnQudHlwZV1dLmVtaXQoe2V2ZW50LCBkYXRhfSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5ncmlkUmVmLm9uKGV2ZW50TmFtZSwgY2FsbGJhY2tGbik7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbiAvKiogQ2FsbCB0aGUgc3BlY2lmaWMgc2V0dGVyIG1ldGhvZCBvbmNlIHdlIHVwZGF0ZSB0aGUgY29uZmlnIHJlZmVyZW5jZSAqL1xuICB1cGRhdGVHcmlkQ29uZmlnKGNvbmZpZzogYW55KTogdm9pZCB7XG4gICAgaWYoIXRoaXMuZ3JpZFJlZil7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgT2JqZWN0LmVudHJpZXMoY29uZmlnKS5mb3JFYWNoKChba2V5LHZhbHVlXSk9PntcbiAgICAgIGlmKHRoaXMuZ3JpZENvbmZpZ1trZXldICE9PSBjb25maWdba2V5XSl7XG4gICAgICAgIGNvbnN0IHNldHRlck1ldGhvZCA9IGBzZXQke2tleS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKX0ke2tleS5zbGljZSgxKX1gO1xuICAgICAgICB0aGlzLmdyaWRSZWZbc2V0dGVyTWV0aG9kXSAmJiB0aGlzLmdyaWRSZWZbc2V0dGVyTWV0aG9kXSh2YWx1ZSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICB1cGRhdGVEYXRhVGFibGUoZGF0YVRhYmxlOiBhbnkpOiB2b2lkIHtcbiAgICBpZighdGhpcy5ncmlkUmVmKXtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5ncmlkUmVmLnNldERhdGFUYWJsZShkYXRhVGFibGUpO1xuICB9XG59XG4iXX0=